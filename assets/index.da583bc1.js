import{o as e,f as t,s,e as o,k as n,g as a,q as r,r as l,v as c,x as i,y as d,z as u,A as p,B as m,C as v,F as h,a as f}from"./vendor.d9a60650.js";import{t as g}from"./t5.5c6007cb.js";import{B as _,h as y}from"./index.b006d70e.js";import{u as $}from"./use-http.7d0e6491.js";var w={chessboard:"_chessboard_13z61_2"};const L={};(L.__cssModules={}).$style=w,L.render=function(o,n){return e(),t("div",{class:[o.$style.chessboard]},[s(o.$slots,"default")],2)};var b=o({name:"map-container",components:{BackgroundChessboard:L}});(b.__cssModules={}).$style={"map-container":"_map-container_17xt2_2"},b.render=function(o,l,c,i,d,u){const p=n("background-chessboard");return e(),t("div",{class:o.$style["map-container"]},[a(p,null,{default:r((()=>[s(o.$slots,"default")])),_:3})],2)};var x=o({name:"map-container-inner",setup(){const e=l(),t=()=>{const t=e.value,s=t.offsetParent,{clientWidth:o,clientHeight:n}=s,{clientWidth:a,clientHeight:r}=t;return{view:{width:o,height:n},size:{width:a,height:r},center:{top:(r-n)/2,left:(a-o)/2,x:a/2,y:r/2},range:{startX:0,startY:0,endX:a-o,endY:r-n}}};let s=0,o=0,n=0,a=0;const r=c({top:0,left:0}),v=i(r,"top"),h=i(r,"left"),f=d((()=>({left:h.value+"px",top:v.value+"px"}))),_=function(t){console.log("trigger touchstart");const r=e.value;s=t.targetTouches[0].pageX,o=t.targetTouches[0].pageY,n=r.offsetLeft,a=r.offsetTop},y=function(r){console.log("trigger touchmove"),e.value;const l=t();var c=r.targetTouches[0].pageX-s,i=r.targetTouches[0].pageY-o;let d=n+c,u=a+i;const{range:{startX:p,startY:m,endX:f,endY:g}}=l;d>p&&(d=p),u>m&&(u=m),d<-f&&(d=-f),u<-g&&(u=-g),v.value=u,h.value=d,r.preventDefault()},$=function(e){console.log("touchend")},w=function(e){console.log("down")},L=function(e){console.log("move")},b=function(e){console.log("up")},x=()=>{(()=>{const s=t();e.value;const{center:{x:o,y:n,top:a,left:r}}=s;v.value=-a,h.value=-r})(),(()=>{const t=e.value;t.addEventListener("touchstart",_),t.addEventListener("touchmove",y),t.addEventListener("touchend",$),t.addEventListener("mousedown",w),t.addEventListener("mousemove",L),t.addEventListener("mouseup",b),t.addEventListener("pointerdown",w),t.addEventListener("pointermove",L),t.addEventListener("pointerup",b)})()},E=(e,s)=>{const o=t(),{range:{startX:n,startY:a,endX:r,endY:l}}=o;s>n&&(s=n),e>a&&(e=a),s<-r&&(s=-r),e<-l&&(e=-l),v.value=e,h.value=s};u((()=>{p((()=>{setTimeout((()=>{E(0,0)}),2e3),setTimeout((()=>{E(200,300)}),5e3),setTimeout((()=>{E(500,300)}),8e3),setTimeout((()=>{E(500,400)}),1e4)}))}));m((()=>{window.removeEventListener("load",x),(()=>{const t=e.value;t.removeEventListener("touchstart",_),t.removeEventListener("touchmove",y),t.removeEventListener("touchend",$),t.removeEventListener("mousedown",w),t.removeEventListener("mousemove",L),t.removeEventListener("mouseup",b)})()}));return{mapRef:e,mapStyle:f,t5:g,imageLoadHandle:()=>{x()},mapClickHandle:e=>{const s=t(),{view:{width:o,height:n}}=s,{offsetX:a,offsetY:r}=e;let l=n/2-r,c=o/2-a;const{range:{startX:i,startY:d,endX:u,endY:p}}=s;c>i&&(c=i),l>d&&(l=d),c<-u&&(c=-u),l<-p&&(l=-p),v.value=l,h.value=c}}}});var E={t5:"_t5_vd2q0_2","map-container-inner":"_map-container-inner_vd2q0_8"};(x.__cssModules={}).$style=E,x.render=function(o,n){return e(),t("div",{ref:"mapRef",class:o.$style["map-container-inner"],style:o.mapStyle,onClick:n[2]||(n[2]=(...e)=>o.mapClickHandle&&o.mapClickHandle(...e))},[a("img",{src:o.t5,onLoad:n[1]||(n[1]=(...e)=>o.imageLoadHandle&&o.imageLoadHandle(...e)),alt:"",style:{display:"none"}},null,40,["src"]),a("div",{class:o.$style.t5},[s(o.$slots,"default")],2)],6)};var H=o({name:"shop-a",setup:()=>({test:e=>{console.log(1)}})});(H.__cssModules={}).$style={"shop-a":"_shop-a_1hchu_2"},H.render=function(s,o,n,a,r,l){return e(),t("div",{class:s.$style["shop-a"],onClick:o[1]||(o[1]=v(((...e)=>s.test&&s.test(...e)),["stop"]))},null,2)};var T=o({name:"shop-b"});(T.__cssModules={}).$style={"shop-b":"_shop-b_1jknw_2"},T.render=function(s,o,n,a,r,l){return e(),t("div",{class:s.$style["shop-b"]},null,2)};var X=o({name:"shops",components:{ShopA:H,ShopB:T}});var Y={shops:"_shops_1czwx_2","shop-a":"_shop-a_1czwx_3","shop-b":"_shop-b_1czwx_7"};(X.__cssModules={}).$style=Y,X.render=function(s,o,r,l,c,i){const d=n("shop-a"),u=n("shop-b");return e(),t(h,null,[a(d,{class:s.$style["shop-a"]},null,8,["class"]),a(u,{class:s.$style["shop-b"]},null,8,["class"])],64)};var k=o({name:"custom-map",components:{MapContainer:b,MapContainerInner:x,Shops:X},setup(){const{request:e}=(f.defaults.baseURL=_,f.interceptors.response.use((e=>Promise.resolve(e.data)),(e=>Promise.reject(e))),{request:e=>f(e)});(async()=>{try{const t=await e({url:"/index/test"});console.log("testApi: ",t.data.now)}catch(t){console.log(t)}})();const{http:t}=$();(async()=>{try{const e=await t({url:"/index/test"});console.log("testUseHttp",e.data.now)}catch(e){console.log(e)}})();const{queryTest:s}={queryTest:e=>y({method:"get",url:"/index/test",data:e})};return(async()=>{const e=await s({id:"1"});console.log("测试use-demo-services：",e.data.now)})(),{name:"peter"}},created(){this.testHttp()},mounted(){console.log("测试插件$perf:",this.$perf),console.log("测试插件$http:",this.$http)},methods:{async testHttp(){try{const e=await this.$demoServices.test();console.log("测试this.$demoServices.test",e.data.now);const t=await this.$http({method:"get",url:"/index/test"});console.log("testHttp:",t.data.now)}catch(e){console.log(e)}}}});var C={map:"_map_tix9z_2"};(k.__cssModules={}).$style=C,k.render=function(s,o,l,c,i,d){const u=n("shops"),p=n("map-container-inner"),m=n("map-container");return e(),t("div",{class:s.$style.map},[a(m,null,{default:r((()=>[a(p,null,{default:r((()=>[a(u)])),_:1})])),_:1})],2)};export default k;
